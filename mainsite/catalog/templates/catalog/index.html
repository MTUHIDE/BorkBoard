{% extends 'base.html' %}
{% block content %}

<div class="row">
  <!--Aligns all the contents of the side bar to the cetner, and fixes the size of the col the side bar in in -->
 <div class="col align-center" style="-ms-flex: 0 0 230px; flex: 0 0 230px;">
  <div class="wrapper">
    <!--Fixes the size of the side bar so it doent grow or shink. -->
    <div id="sidebar" style="text-align: center;background-color: black; height: 100%;width:230px; position: fixed; top: 50px;">
      <div class="sidebar-header">
        <h1 class="my-4" style="color: #ffcd00; text-align: center;">Catalog</h1>
      </div>
      <div style="display: inline-block;">

       {% for filter in filters %}
          {% if not curFilters %}
            <form action="/catalog/filter/" method="get">
          {% elif filter.category_name in curFilters %}
            <form action="/catalog/filter/">
          {% else %}
            <form action="/catalog/filter/">
          {% endif %}
          {% if not curFilters %}
            <button type="submit" name="filter" value="{{filter.category_name}}" class="btn btn-outline-warning" style="width: 100%; margin-bottom: 20px;">{{filter.category_name}}</button>
          {% elif filter.category_name in curFilters %}
             <button type="button" class="btn btn-outline-warning" style="width: 100%; margin-bottom: 20px; background-color:#ffcd00; color:black;" onclick="removeFromUrl('{{filter.category_name}}')">{{filter.category_name}}</button>
          {% else %}
             <button type="button" class="btn btn-outline-warning" style="width: 100%; margin-bottom: 20px;" onclick="appendToUrl('filter', '{{filter.category_name}}')">{{filter.category_name}}</button>
          {% endif %}
           </form>
        {% endfor %}
        <button type="button" class="btn btn-outline-warning" style="width: 100%; margin-bottom: 20px;" onclick="">Clear Filters</button>
      </div>
    </div>
  </div>
</div>


    <!-- /.col-lg-3 -->
    <div class="col " style="position: static;height: 100%;">


      {% if failed_search %}
        <div style="background-color: black; border: 2px solid black; border-spacing: 10px; text-align: center; margin-bottom: 20px; margin-top: 10px;">
            <h1 style="color: #ffcd00; margin-top: 3px; margin-bottom: 1.5px;">Oops!</h1>
            <h6 style="color: #ffcd00; margin-top: 1.5px; margin-bottom: 3px;">

              {% if failed_search == 'MisformedFilterFail' %}
              Seems like one of your filters isn't valid, so we couldn't find any results.
              <br>Please <a href="{% url 'catalog:index' %}" >return to</a> the catalog, then select filters from the sidebar.
              {% elif failed_search == 'FilterFail' %}
              Looks like no items have been uploaded for {% if curFilters|length > 1 %} those categories{% else %}that category{% endif %}. But here are some recently-uploaded items instead!
              {% elif failed_search == 'PageNotFoundFail' %}
              Looks like that item couldn't be found. But here are some recently-uploaded items instead!
              {% elif failed_search == 'SearchFail' %}
              Looks like no items could be found for your search. But here are some recently-uploaded items instead!
              {% else %}
              Looks like something went wrong. Please contact MTU HuskyHunt if this error persists.
              {% endif %}

            </h6>
        </div>
      {% endif %}
      <!-- -->

        <div class="row">
            {% if items %}
            {% for item in items %}
            <div class="col col-lg-3 col-md-6 ">
                <div class="card h-100"  style="border: 2px solid black; width: auto; margin: 7px;">
                    <a href="\catalog\{{item.id}}"><img class="product-icon" src="{{ item.item_picture.url }}" alt=""></a>
                    <div class="card-body">
                        <h4 class="card-title" style="color: black;">
                            <div style="width: auto; text-overflow: ellipsis; white-space: nowrap; overflow: hidden; color: black;">
                                <a href="\catalog\{{item.id}}" style="color: black; line-height: normal;">{{ item.item_title }}</a>
                            </div>
                        </h4>
                        <h6>${{ item.item_price }}</h6>
                        <!--
                        <div style="width: auto; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;">
                            <p class="card-text">{{ item.item_description }}</p>
                        </div>
                    -->
                </div>
                <div class="card-footer" style="background-color: black;"> <!--black-->
                    <div style="text-align: center; width: auto;">
                        <h5 class="card-text" style="color: #ffcd00;">{{ item.first_name }}</h5>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
        {% endif %}
    </div>

{% if items.paginator.num_pages > 1 %}
    <div class="pagination">
        <span class="step-links">
            {% if items.has_previous %}
            <button type="button" class="btn btn-link" style="display: inline-block;" onclick="appendToUrl('page', '1')">
            &laquo; first
            </button>

            <button type="button" class="btn btn-link" style="display: inline-block;" onclick="appendToUrl('page', '{{ items.previous_page_number }}')">
            previous
            </button>
            {% endif %}

            <span class="current">
                Page {{ items.number }} of {{ items.paginator.num_pages }}.
            </span>

            {% if items.has_next %}
            <button type="button" class="btn btn-link" style="display: inline-block;" onclick="appendToUrl('page', '{{ items.next_page_number }}')">
            next
            </button>

            <button type="button" class="btn btn-link" style="display: inline-block;" onclick="appendToUrl('page', '{{ items.paginator.num_pages }}')">
            last &raquo;
            </button>

            {% endif %}
        </span>
    </div>
{% endif %}


  </div>


</div>

{% endblock %}
