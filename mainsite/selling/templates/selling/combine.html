{% extends 'base.html' %}
{% block content %}

<!-- Does not display the above-line default validation errors for the forms
Instead we display our custom error message -->
<style>
.errorlist {
    display: none;
}
</style>

<!-- Show ride tab if errors exist -->
{% if ride_form.errors %}
  <body onload="showRides()"></body>
{% endif %}

<!-- Nav tabs -->
<div class="col-lg-12 col-md-9 col-sm-8" align="center" style="position: static;">
  <ul class="nav nav-tabs justify-content-center" role="tablist">
    <li role="presentation" class="nav-item"><a class="nav-link active" href="#ctlg" role="tab" data-toggle="tab">Marketplace</a></li>
    <li role="presentation" class="nav-item"><a class="nav-link" href="#ride" role="tab" data-toggle="tab">Ridesharing</a></li>
  </ul>
</div>
<br>

<!-- Tab contents -->
<div class="tab-content">

  <!-----------------------------------
  Catalog Form
  ----------------------------------->
   <div role="tabpanel" class="tab-pane active" id="ctlg">
     <div class='row justify-content-center'>
         <div class='col-lg-5'>
            <!-- Catalog Form Errors -->
             {% if catalog_form.errors %}
                 <div class="alert alert-danger" role="alert">
                      {% for field in catalog_form %}
                        {% if field.errors %}
                          <strong>{{ field.label }}: {{ field.errors|striptags }}<br></strong>
                        {% endif %}
                      {% endfor %}
                 </div>
             {% endif %}

             <form role="form" method="post" enctype="multipart/form-data" style='border: 2xp;'>
                 {% csrf_token %}
                 <input type="hidden" name="submission_type" value="ctlg">

                 {{ catalog_form.as_p}}
                 <button type="submit" onclick="ItemInput()" class="btn btn-primary" id="btnRealButton">Submit</button>
             </form>

             <!-- General Form Formatting -->
              {% for field in catalog_form %}
                <script type="text/javascript">
                  document.getElementById("{{field.id_for_label}}").classList.add('form-control');
                </script>
              {% endfor %}

              <script type="text/javascript">
                document.getElementById("id_item_field").classList.add('file-field');
              </script>

              <!-- Highlight Fields -->
             {% if catalog_form.errors %}
                {% for field in catalog_form %}
                    {% if field.errors %}
                      <script type="text/javascript">
                        document.getElementById("{{field.id_for_label}}").classList.add('is-invalid');
                      </script>
                    {% else %}
                      <script type="text/javascript">
                        document.getElementById("{{field.id_for_label}}").classList.add('is-valid');
                      </script>
                    {% endif %}
                {% endfor %}
             {% endif %}

         </div>
     </div>
   </div>

   <!-----------------------------------
   Ridesharing Form
   ----------------------------------->
   <div role="tabpanel" class="tab-pane" id="ride">
     <form action="" method="post">
       {% csrf_token %}
       <input type="hidden" name="submission_type" value="ride">
       <div class="col-lg-12 col-md-9 col-sm-8" align="center" style="position: static;">

        <!-- Ride Form Errors -->
        {% if ride_form.errors %}
        <div class="alert alert-danger" role="alert">
          {% for field in ride_form %}
            {% if field.errors %}
              <strong>{{ field.label }}: {{ field.errors|striptags }}<br></strong>
            {% endif %}
          {% endfor %}
        </div>
        {% endif %}

         <div class="row justify-content-center align-end">
           <table>
             {{ ride_form.as_table }}
           </table>
         </div>
       </div>
       <div class="col-lg-12 col-md-9 col-sm-8" align="center" style="position: static;">
          <button type="submit" onclick="RideInput()" class="btn btn-primary" id="btnRealButtonRide" onclick="RideInput()">Submit</button>
       </div>
     </form>

     <!-- General Form Formatting -->
        {% for field in ride_form %}
          <script type="text/javascript">
            document.getElementById("{{field.id_for_label}}").classList.add('form-control');
          </script>
        {% endfor %}

      <!-- Highlight Fields -->
        {% if ride_form.errors %}
          {% for field in ride_form %}
            {% if field.errors %}
              <script type="text/javascript">
                document.getElementById("{{field.id_for_label}}").classList.add('is-invalid');
              </script>
            {% else %}
              <script type="text/javascript">
                document.getElementById("{{field.id_for_label}}").classList.add('is-valid');
              </script>
            {% endif %}
          {% endfor %}
        {% endif %}
   </div>


<!-- Used to prevent multiple submits -->
<script type="text/javascript">
  function ItemInput() {
      document.getElementById("btnRealButton").disabled = true;
      document.getElementById("btnRealButton").form.submit();

  }
  function RideInput() {
      document.getElementById("btnRealButtonRide").disabled = true;
      document.getElementById("btnRealButtonRide").form.submit();
  }
</script>

<script type="text/javascript">
  function showRides() {
    $('[href="#ride"]').tab('show');
  }
</script>


 </div>

{% endblock %}